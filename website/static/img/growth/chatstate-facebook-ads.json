{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"5a1b30a4-9f9d-4ff0-83ae-6319dd348545","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:14829"}],"$conditionOutputs":[{"stateId":"5046bfbb-9a7a-4be9-90fe-6e0a614121fc","$connId":"con_3","conditions":[{"source":"context","comparison":"equals","values":["application/vnd.lime.chatstate+json"],"$$hashKey":"object:5319","variable":"input.type"}],"$invalid":false,"$$hashKey":"object:5310"},{"stateId":"5046bfbb-9a7a-4be9-90fe-6e0a614121fc","$connId":"con_8","conditions":[{"source":"input","comparison":"startsWith","values":["[payload] -"],"$$hashKey":"object:3240","variable":"eDeAnuncio"}],"$$hashKey":"object:3193","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"467db37d-df41-4f4b-823e-ab800434442b","$invalid":false},"$tags":[],"id":"onboarding","root":true,"$position":{"top":"108px","left":"617px"},"$title":"Start","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"234f8083-5906-4462-a9e3-6c6cbea86ee1","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:305"}],"$conditionOutputs":[{"stateId":"18c77b1b-4b10-4c8c-8ef0-0f2dd2823087","conditions":[{"source":"context","comparison":"equals","values":["oioi"],"$$hashKey":"object:350","variable":"resultadoDeAnalise@intencao"}],"$connId":"con_13","$invalid":false,"$$hashKey":"object:331"},{"stateId":"error","$connId":"con_18","conditions":[{"source":"context","comparison":"equals","values":["tchautchau"],"$$hashKey":"object:19665","variable":"resultadoDeAnalise@intencao"}],"$invalid":false,"$$hashKey":"object:19618"}],"$enteringCustomActions":[{"type":"ProcessCommand","$title":"Processar comando de Análise","$invalid":false,"settings":{"to":"postmaster@ai.msging.net","method":"set","uri":"/analysis","resource":{"text":"{{mensagemInicial}}"},"type":"application/vnd.iris.ai.analysis-request+json","variable":"resultadoDoComando"},"conditions":[]},{"type":"ExecuteScript","$title":"Interpretar Resultado de Comando","$invalid":false,"settings":{"function":"run","source":"function run(resultadoDoComando) {\n    const resource = JSON.parse(resultadoDoComando).resource;\n    const resultadoInterpretado = {entidades : []};\n    if (resource.intentions.length){\n        resultadoInterpretado.intencao = resource.intentions[0].name;\n        resultadoInterpretado.score = resource.intentions[0].score;\n        for (i=0; i < resource.entities; i++){\n            resultadoInterpretado.entidades.push(resource.entities[i].name)\n        }\n    }\n    return JSON.stringify(resultadoInterpretado);\n}","inputVariables":["resultadoDoComando"],"outputVariable":"resultadoDeAnalise"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"37281f54-80bd-423d-8c8c-98218d639413","$invalid":false},"$tags":[],"id":"fallback","$position":{"top":"80px","left":"1178px"},"$title":"Exceptions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false,"$$hashKey":"object:555"},{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"tchau"},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"tchau"},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false,"$$hashKey":"object:556"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"26d317eb-be61-4945-8aab-81649481b9c6","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:557"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[],"id":"error","$position":{"top":"227px","left":"992px"},"$title":"Tchau","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5046bfbb-9a7a-4be9-90fe-6e0a614121fc":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"be4b2ca8-ad74-4b5c-ad5a-e3953133a08a","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$$hashKey":"object:4425","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"type":"ExecuteScript","$title":"Definir mensagem inicial","$invalid":false,"settings":{"function":"run","source":"function run(mensagem) {\n    const prefixoPayload = '[payload] - ';\n    if (mensagem.indexOf(prefixoPayload) != -1) {\n        return mensagem.split(prefixoPayload)[1];\n    } else {\n        return mensagem;\n    }\n}","inputVariables":["input.content"],"outputVariable":"mensagemInicial"},"conditions":[{"$$hashKey":"object:17320","source":"context","comparison":"notEquals","variable":"input.type","values":["application/vnd.lime.chatstate+json"]}]}],"$leavingCustomActions":[{"type":"ExecuteScript","$title":"Definir mensagem inicial","$invalid":false,"settings":{"function":"run","source":"function run(mensagem) {\n    const prefixoPayload = '[payload] - ';\n    if (mensagem.indexOf(prefixoPayload) != -1) {\n        return mensagem.split(prefixoPayload)[1];\n    } else {\n        return mensagem;\n    }\n}","inputVariables":["input.content"],"outputVariable":"mensagemInicial"},"conditions":[{"$$hashKey":"object:5877","source":"context","comparison":"notEquals","variable":"input.type","values":["application/vnd.lime.chatstate+json"]}]},{"type":"SetVariable","$title":"Definir veio pelo anuncio","$invalid":false,"settings":{"variable":"veioPeloAnuncio"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db49d42a-4545-41b7-bfad-cfede35b7c9a","$invalid":false},"$tags":[],"id":"5046bfbb-9a7a-4be9-90fe-6e0a614121fc","root":false,"$title":"Início com chatstate","$position":{"top":"238px","left":"475px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"467db37d-df41-4f4b-823e-ab800434442b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"41ff7ec3-a5be-4075-81d4-d80dc7508dcf","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$$hashKey":"object:7282","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"type":"SetVariable","$title":"Definir mensagem inicial","$invalid":false,"settings":{"variable":"mensagemInicial","value":"{{input.content}}"},"conditions":[]},{"type":"SetVariable","$title":"Definir veio pelo anuncio","$invalid":false,"settings":{"variable":"veioPeloAnuncio","value":"Não"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"db49d42a-4545-41b7-bfad-cfede35b7c9a","$invalid":false},"$tags":[],"id":"467db37d-df41-4f4b-823e-ab800434442b","root":false,"$title":"Início sem chatstate","$position":{"top":"235px","left":"766px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"db49d42a-4545-41b7-bfad-cfede35b7c9a":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"1478f5a1-9c10-4fa4-9724-299723fc1c54","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1478f5a1-9c10-4fa4-9724-299723fc1c54","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:14340"},{"action":{"type":"SendMessage","settings":{"id":"a1d09b0f-99c9-4828-a40b-5d3141fd04a9","type":"text/plain","content":"{{veioPeloAnuncio}} veio pelo anúncio\nTexto - {{mensagemInicial}}"},"$cardContent":{"document":{"id":"a1d09b0f-99c9-4828-a40b-5d3141fd04a9","type":"text/plain","content":"{{veioPeloAnuncio}} veio pelo anúncio\nTexto - {{mensagemInicial}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:14341"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"53de3060-8d77-4ced-9965-b6cdf439887d","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$$hashKey":"object:13909","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[],"id":"db49d42a-4545-41b7-bfad-cfede35b7c9a","root":false,"$title":"União do fluxo","$position":{"top":"354px","left":"629px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"18c77b1b-4b10-4c8c-8ef0-0f2dd2823087":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"d6e0092e-ae29-4bd0-905d-038ea69444ff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d6e0092e-ae29-4bd0-905d-038ea69444ff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:19157"},{"action":{"type":"SendMessage","settings":{"id":"e86267f6-6c39-4c29-9cde-a72d5dfd24a5","type":"text/plain","content":"Oi"},"$cardContent":{"document":{"id":"e86267f6-6c39-4c29-9cde-a72d5dfd24a5","type":"text/plain","content":"Oi"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:19158"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"8beebc48-5b04-4f81-9284-5b055493b771","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$$hashKey":"object:17106","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[],"id":"18c77b1b-4b10-4c8c-8ef0-0f2dd2823087","root":false,"$title":"Oi","$position":{"top":"222px","left":"1385px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"37281f54-80bd-423d-8c8c-98218d639413":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"951c0431-df56-45ae-af55-a55f4c1536ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"951c0431-df56-45ae-af55-a55f4c1536ba","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:25803"},{"action":{"type":"SendMessage","settings":{"id":"5c90e4cc-12c5-497c-839c-5616390f6716","type":"text/plain","content":"Nenhuma intenção reconhecida"},"$cardContent":{"document":{"id":"5c90e4cc-12c5-497c-839c-5616390f6716","type":"text/plain","content":"Nenhuma intenção reconhecida"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:25804"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6f878e12-7d94-4dd9-a8c4-2c27ff7e416b","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$$hashKey":"object:25484","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"$tags":[],"id":"37281f54-80bd-423d-8c8c-98218d639413","root":false,"$title":"Nenhuma intenção","$position":{"top":"225px","left":"1189px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}